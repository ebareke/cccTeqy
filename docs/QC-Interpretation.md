# üß™ QC Interpretation Guide ‚Äî cccTeqy
A practical guide for understanding, interpreting, and troubleshooting all QC metrics generated by the **cccTeqy** pipeline.

This document is designed for biologists, bioinformaticians, and computational scientists analyzing ChIP-seq, CUT&RUN, and CUT&Tag datasets.

---

# üìä Overview of QC Modules
cccTeqy generates the following QC outputs:
- **FastQC** ‚Äî raw read quality
- **Picard MarkDuplicates** ‚Äî duplication metrics
- **Preseq** ‚Äî library complexity
- **deepTools Fragment Size** ‚Äî nucleosome patterning
- **PhantomPeakQualTools** ‚Äî cross-correlation QC (NSC/RSC)
- **FRiP** ‚Äî fraction of reads in peaks
- **MACS2** outputs ‚Äî peak call diagnostics
- **MultiQC** ‚Äî overall consolidation

Each module provides signals about library quality, technical bias, and biological success.

---

# üß¨ 1. FastQC Interpretation
FastQC provides a quick overview of raw FASTQ quality.

### Key Metrics
- **Per-base quality**: Should be high (green zone). ChIP/CUT&RUN/CUT&Tag are usually high.
- **Adapter content**: Some presence is normal; heavy adapter presence suggests over-amplification.
- **Sequence duplication levels**: Expected to be higher than RNA-seq; interpretation left to Picard.

### Red Flags
- Severe quality drop at read ends ‚Üí trimming recommended.
- Overrepresented sequences ‚Üí contamination.
- High adapter levels ‚Üí consider trimming.

---

# üß¨ 2. Picard Duplication Metrics
Shows duplication rates, optical duplicates, and library size estimates.

### Expected Ranges
| Assay | Typical Duplication |
|-------|----------------------|
| ChIP-seq (TF) | 10‚Äì60% |
| Histone ChIP-seq | 20‚Äì70% |
| CUT&RUN | 5‚Äì40% |
| CUT&Tag | 20‚Äì80% |

### Red Flags
- **>80% duplicates** ‚Üí library bottleneck, low complexity, over-amplification.
- High optical duplicates ‚Üí sequencing/flowcell artifacts.

---

# üìà 3. Preseq (Library Complexity)
Preseq predicts how many **new unique reads** you'd get if sequencing deeper.

### Interpretation
- **Upward curve**: Good ‚Äî more sequencing yields more usable reads.
- **Flat early**: Library saturated ‚Äî sequencing deeper is not useful.

CUT&RUN/CUT&Tag often show good complexity due to low background.

---

# üìè 4. Fragment Size (deepTools)
Fragment length distribution reveals biological signal quality.

### Expected Profiles
- **CUT&RUN**: Strong mono-nucleosome (~150 bp) and di-nucleosome (~300 bp) peaks.
- **CUT&Tag**: Often short (~80‚Äì120 bp) fragments from Tn5 insertion.
- **ChIP-seq**: Broader fragment distribution (~200 bp average).

### Red Flags
- Flat distribution ‚Üí low enrichment.
- Very short fragments (<50 bp) ‚Üí adapter dimers.
- Excessively long fragments (>1 kb) ‚Üí poor shearing.

---

# üìâ 5. PhantomPeakQualTools (Cross-Correlation)
Provides three core metrics:

### 1. **NSC** (Normalized Strand Cross-correlation)
- Good: **1.05‚Äì1.3** (histone)
- Good: **1.1‚Äì2.0** (TF ChIP)

### 2. **RSC** (Relative Strand Cross-correlation)
- Good: **‚â• 0.8** (minimal)
- Strong: **1.0‚Äì2.0**

### 3. **Estimated fragment length**
- Should match fragment length QC.

### Red Flags
- **NSC < 1.05** ‚Üí poor enrichment.
- **RSC < 0.5** ‚Üí severe background.
- **No clear fragment peak** ‚Üí signal too noisy.

---

# ‚≠ê 6. FRiP (Fraction of Reads in Peaks)
FRiP measures the % of aligned reads that fall in detected peaks.

### Expected Ranges
| Assay | Typical FRiP |
|-------|--------------|
| TF ChIP-seq | 1‚Äì15% |
| Histone ChIP-seq | 10‚Äì50% |
| CUT&RUN | 20‚Äì60% |
| CUT&Tag | 20‚Äì70% |

### Red Flags
- **FRiP < 1%** ‚Üí likely failed ChIP.
- **FRiP < 5%** (TF) ‚Üí weak signal.
- **FRiP < 10%** (histone) ‚Üí high noise.

---

# üìê 7. MACS2 Peak Calling Diagnostics
### Narrow Peaks (TF)
- Thousands of peaks expected.
- Too few peaks ‚Üí weak enrichment.

### Broad Peaks (Histone)
- Long domains expected.
- Very fragmented domains ‚Üí noise.

MACS2 `.model.r` plots often indicate fragment shifts.

---

# üß© 8. MultiQC Summary
MultiQC integrates all QC metrics.

### What to check
- Alignment rate
- Duplication levels
- Insert size distribution
- NSC/RSC
- FRiP
- Peak counts

Consider MultiQC as the **final QC validation**.

---

# üö® 9. QC Failure Scenarios & Interpretation
### Case: Low alignment rate (<60%)
- Wrong genome build?
- Contamination?
- Adapter dimers?

### Case: Very high duplicates (>80%)
- Over-amplification
- Low complexity library

### Case: No peaks detected
- Poor enrichment
- Wrong MACS2 genome-size
- Wrong ASSAY type

### Case: Very low FRiP (<1%)
- Likely assay failure

---

# üß† 10. Final Recommendations
- Always combine multiple QC metrics.
- FRiP + NSC/RSC are the strongest biological quality indicators.
- Preseq + Picard reveal library health.
- Fragment size reveals assay-specific signal.
- MultiQC provides a holistic view.

---

<p align="center"><b>High-quality QC ensures high-confidence biology. Trust the metrics.</b></p>

